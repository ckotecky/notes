2022-11-07
Přednáška #6
------------



Množinové pokrytí
=================



Pb: Množinové pokrytí (set cover)
---------------------------------
1. Vstup:
	1. `S_1, ..., S_m ⊆ [n]`
	2. `c_1, ..., c_m ≥ 0`
	- pokud množiny nepokrývají nějaký prvek, instance nemá řešení
2. Výstup: `I ⊆ [m]: ∪_{j ∈ I} S_j = [n]`
3. Cíl: Minimalizovat `Σ_{j ∈ I} c_j`
4. Parametry:
	1. `f = max_{i ∈ [n]} |\{j: i ∈ S_j\}|`
	2. `g = max_{j ∈ [n]} |S_j|`


Pz: Vrcholové pokrytí
---------------------
- speciální případ
- hrany jsou vrcholy `[n]`
- množiny `S_j` jsou hrany sdílející vrchol


Df: LP Množinového pokrytí
--------------------------
1. `P` primární
	- `x_1, ..., x_n ≥ 0`   nebo   `x_1, ..., x_n ∈ \{0,1\}`
	- `min Σ_{j ∈ [m]} c_j x_j`
	- `∀ i ∈ [n]: Σ_\{j: i ∈ Sj\} x_j ≥ 1`
2. `D` duální
	- `y_1, ..., y_m ≥ 0`
	- `max Σ_{i ∈ [n]} y_i`
	- `∀_j ∈ [m]: Σ_{i ∈ S_j} y_i ≤ c_j`
	+ `y_i` cena vrcholu `i`
	+ snaží se maximalizovat ceny, aby vycházely na ceny množin


Pz: LP Množinového pokrytí
--------------------------
1. z **duality** `Σx_i c_i ≥ Σ y_j`
2. z **podmínek komplementarity** `x,y` jsou optimální  `<=>`
	- `∀ i ∈ [n]: Σ_{j: i ∈ S_j} x_j = 1  ∨  y_i = 0`
	- `∀ j ∈ [m]: Σ_{i ∈ S_j} yi = cj   ∨   x_j = 0`


Alg: Hladový
------------
1. `I = ∅  (I ⊆ [n])`
2. `E = ∅  (E ⊆ [m])`
3. `q = 0`
4. Dokud `E ≠ [n]:`
5. 		`p_j = c_j / (S_j \ E)` 	 					(nemusí být definované, takové množiny nechceme)
6.   	`j_0: p_j e_j` definované a minimální
7.    	`I = I ∪ \{j_0\}`
8.     	`E = E ∪ \{S{j_0}\}`
9.      `q_i = p_\{j_0\}: ∀ i ∈ S_{j_0}`
10. Vrátíme `I`



Lm: 1
-----
- `∀j ∈ [m]: Σ_{i ∈ S_j} q'i ≤ c_j`

### Důkaz:
- vezmeme pevné `j: S_j = {x_1, ..., x_k}`
- očíslujeme tak, že pokryjeme `S_j` v pořadí `x_k, x_{k-1}, ..., x_1`
- `q_{x_t}` cena, která pokryje `x_t`
- `q_{x_t} ≤ c_j / t`
- `Σ_{i ∈ S_j} q'i = q_{x_k} + q_{x_{k-1}} + ... + q_{x_1} ≤ c_j/k + c_j/(k-1) + ... + c_j/2 + c_j/1 ≤ c_j H_k ≤ c_j H_g`


Ds: 1
-----
- `q' = 1/H_g * q` je duální přípustné řešení


Vt: 1
-----
- Hladový algoritmus je `H_g`-aproximační			`(H_g ≤ H_n ≤ O(log n))`

### Důkaz:
- alg je evidentně polynomiální
- skončí s přípustným řešením
- cena z alg = `Σ_{j ∈ I} c_j = Σ_{i ∈ [n]} q_i = H_g * Σ_{i ∈ [n]} q'i ≤ H_g * OPT`
	+ každé `q_i` změníme jednou
	+ `∀` kroku nastavíme tolik `q_i`, že jejich součet je `c_j`
- `q'` (přípustné pro `D`) `≤ OPT_LP ≤ OPT ≤ ALG`


Alg: LP
-------
1. `x^*` optimum LP `P`
2. Vydáme `{j: x_j^* ≥ 1/f} = I`


Vt: LP
------
- LP algoritmus je `f`-aproximační

### Důkaz:
- LP je polynomiální
- při zaokrouhlení každou hodnotu zvýšíme nejvýš `f`-krát



Alg: PD (komplementární)
------------------------
1. `y = 0`
2. `I = ∅`
3. `E = ∅`
4. Dokud `∃ i: i ∉ E:`
5. 		Nastav `y_i` co nejvyšší, aby bylo v duálu stále přípustné:
6.   		`δ = min_j (c_j - Σ_{i ∈ Sj} x_i)`
7.    		`y_i = y_i + δ`
8.      Do `I` přidáme `∀_j: Σ_{i ∈ S_j} y_i = c_j`
9.      `E = E ∪ S_j`


Pz: PD
------
- `∀ y_i` zvýšíme nejvýš jednou


Vt: PD
------
- PD algoritmus je `f`-aproximační

### Důkaz:
- cena algoritmu  `=  Σ_{j ∈ I} c_j  =  Σ_{j ∈ I} Σ_{i ∈ Sj} y_i  =  Σ_i Σ_{j: i ∈ S_j} y_i  ≤  f * Σ_i y_i  ≤  f * OPT`