2022-11-14
Přednáška #7
------------



Splnitelnost
============


Pb: MAX-SAT
-----------
1. Vstup:
	- klauzule `C_1, ..., C_k`
	- s proměnnými `x_1, ..., x_n`
	- a váhami `w_1, ..., w_k`
2. Výstup: ohodnocení proměnných
3. Cíl: Maximalizovat součet vah splněných klauzulí


Df: Literál
-----------
1. proměnná `x` a její negace `{x}`
2. **positivní** proměnná `x`
3. **negativní** negace proměnné `{x}`


Nt: Předpoklady (BÚNO)
----------------------
1. `∀` klauzule neobsahuje proměnnou i její negaci
2. `∀` klauzuli `∀` proměnná vyskytuje nejvýš jednou


Alg: Rand-SAT
-------------
1. `∀i`: nezávisle náhodně s nastavíme `x_i = \{`
	- 1 	pravděpodobnost `1/2`
	- 0 	pravděpodobnost `1/2`


Df: Indikátory klauzulí
-----------------------
- `∀` klauzuli `C_j` zavedeme indikátor `Y_j = \{`
	- 1 	`C` je splněna náhodným přiřazením
	- 0 	jinak
	

Vt: Rand-SAT
------------
- Rand-SAT je 2-aproximační

### Důkaz:
- uzažme klauzuli `C_j` délky `l`
- `P[Y_j = 1] = 1 - 2^{-l}`
	+ `≥ 1/2` (protože klauzule jsou neprázdné)
- `W = Σ w_j Y_j`
- `𝔼[Y_j] = P[Y_j = 1]`
- `𝔼[W] = Σ w_j * 𝔼[Y_j]`
- `OPT ≤ Σ w_j`
- `Σ w_j * 𝔼[Y_j] ≥ 1/2 OPT`


Lm: Rand-SAT 
-------------
- pro náhodné proměnné `X,Y: 𝔼[X] = Σ_{y ∈ Im(Y)} P[Y = y] * 𝔼[X | Y = y]`



Pz: Aplikace lemmatu
--------------------
- `𝔼[W] = Σ P[X_1 = x] * 𝔼[W | X_1 = x] = 1/2 * 𝔼[W | X_1 = 1] + 1/2 * 𝔼[W | X_1 = 0]`
- větší ze sčítanců přispívá aspoň `1/2 𝔼[W]`
- tedy `𝔼[W] ≤ max{𝔼[W | X_1 = 1], 𝔼[W | X_1 = 0]}`


Pz: Derandomizace
-----------------
1. v polynomiálním čase umíme přesně spočítat `𝔼[W | X_1 = 1], 𝔼[W | X_1 = 0]`
2. nastavíme `X_1 = b_1: 𝔼[W | X_1 = b_1] ≥ 𝔼[W | X_1 = {b_1}]`
3. `𝔼[W | X_1 = b_1] ≥ 𝔼[W] ≥ OPT/2`
	- tedy nejhorší výsledek bude stený jako v Rand-SAT
	
4. Předpokládejme, že jsme nastavili `X_1 = b_1, ..., X_i = b_i: 𝔼[W | X_1 = b_1, ..., X_i = b_i] ≥ 𝔼[W]`
5. Zpozorujeme, že `𝔼[W | X_1 = b_1, ..., X_i = b_i] = 1/2 * 𝔼[W | X_1 = b_1, ..., X_i = b_i, X_{i+1} = 1] + 1/2 * 𝔼[W | X_1 = b_1, ..., X_i = b_i, X_{i+1} = 0]`


Alg: Derandomizovaný Rand-SAT
-----------------------------
1. `∀i ∈ [n]:`
2. 		Pokud `𝔼[W | X_1 = b_1, ... , X_{i-1} = b_{i-1}, X_i = 1] ≥ 𝔼[W | X_1 = b_1, ... , X_{i-1} = b_{i-1}, X_i = 0]:`
3.   		`b_i = 1`
4.     	Jinak:
5.      	`b_i = 0`
6. Vrátíme `b_1, ..., b_n`


Pz: Derandomizovaný Rand-SAT
----------------------------
- 3-SAT - `7/8 OPT`
- `∀ε > 0: 7/8 + ε` aproximace je np-těžká


Nt: Předpoklad (BÚNO)
---------------------
- `∀i: Σ_{j: C_j = x_i} w_j ≥ Σ{j: C_j = {x_i}} w_j`
	+ BÚNO protože můžeme přehodit čemu říkáme `x_i` a čemu `{x_i}`


Alg: Biased-SAT
---------------
1. `∀ i ∈ [n]` nezávisle náhodně nastav `x_i = \{`
		- 1 	s pravděpodobností `p > 1/2`
		- 0 	s pravděpodobností `1 - p`
		

Pz: Biased-SAT 1
----------------
- Pro klauzuli `C_j` dva možné případy:
	1. `|C_j| = 1`, literál `C_j` je positivní
		- `P[Y_j = 1] = p`
	2. `|C_j| ≥ 2`
		- `a =` # positivních literálů v `C_j`
		- `b =` # negativních literálů v `C_j`
		- `P[Y_j = 1] = 1 - (p^b * (1 - p)^a) ≥ 1 - p^{a + b} ≥ 1 - p^2`
		+ tedy zvolíme `p = 1 - p^2`, aby odhady vyšly stejně
		

Pz: Biased-SAT 2
----------------
- `U =` množina klauzulí bez těch jednotkových negativních
- `OPT ≤ Σ_{j ∈ U} w_j`
	+ díky předpokladu

Vt: Biased-SAT
--------------
- Biased SAT je `(√5 - 1)/2`-aproximační

### Důkaz:
- `𝔼[W] = 𝔼[Σ{i ∈ [k]} w_j Y_j] = Σ_{i ∈ [k]} w_j * P[Y_j = 1] ≥ Σ_{j ∈ U} w_j * p = p * Σ_{j ∈ U} w_j ≥ p * OPT`
- `p = (√5 - 1)/2 > 1/2 ~ 0.618`


Df: LP relaxace a pravděpodobnostní zaokrouhlování
--------------------------------------------------
1. celočíselný program
	1. proměnné:
		- pro booleovskou proměnnou `x_i` zavedeme celočíselnou proměnnou `y_i = \{`
			* 0 	`x_i = 0`
			* 1 	`x_i = 1`
		- pro klauzuli `Cj` zavedeme binární proměnnou `z_j = \{`
			* 0 	`Y_j = 0`
			* 1 	`Y_j = 1`
	2. účelová funkce:
		- `Σ_{j ∈ [k]} w_j * z_j` = součet vah splněných klauzulí
	3. podmínky:
		- `∀j ∈ [k]: Σ_{i: x_i ∈ C_j} y_i + Σ_{i: {x_i} ∈ C_j} (1 - y_i) ≥ z_j`
2. relaxace
	1. proměnné:
		- `∀i: 0 ≤ y_i ≤ 1`
		- `∀j: 0 ≤ z_j ≤ 1`
	2. účelová funkce: `max Σ_{j ∈ [k]} w_j * z_j`
	3. podmínky:
		- `∀j ∈ [k]: Σ_{i: x_i ∈ C_j} y_i + Σ_{i: {x_i} ∈ C_j} (1 - y_i) ≥ z_j`


Alg: LP-SAT
-----------
1. vyřeš LP-relaxaci
2. `∀i ∈ [n]:`
3. 		`x_i = \{`
			- 1 	s pravděpodobností `y_i`
			- 0 	s pravděpodobností `1 - y_i`