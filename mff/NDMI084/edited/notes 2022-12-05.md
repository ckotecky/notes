2022-12-05
Přednáška #10
-------------


Paralelní algoritmy
===================


Df: PRAM model
--------------
- více procesorů
	+ mají přístup ke společné paměťi
	+ pracují synchronně
	+ znají svůj čas
	+ mají stejné operace

- měříme:
	+ čas
		- chceme logaritmický
		- reálně očekáváme polynomiální
	+ počet procesorů
		- chceme polynomiální

1. procesory mají čísla
	- sečíst je umíme v logaritmickém čísle
	
2. nebo mají prefix sum
	- číslo procesoru sčítá předešlá čísla
	- spočítáme v logaritmickém čase
		- v logaritmickém stromu sčítanců pak jdeme zpátky k listům (procesorům) a přičteme jejich číslo k číslu rodiče

Df: Dělící model
----------------
- implemetace simultálních čtení / zápisů
- simultální zápis nebo čtení více procesorů do stejné buňky paměti
	- nezáleží na implementaci



Maximální nezávislá množina
===========================



Pb: Maximální nezávislá množina (Maximal independent set - MIS)
---------------------------------------------------------------
- sekvenčně jednoduché
	- vybereme vrchol, vyškrtáme sousedy, pokračujeme..
- graf může reprezentovat konflikty mezi procesy apod.
- nelze jednoduše aproximovat, špatný aproximační poměr


Alg: Paralelizace
-----------------
1. vybereme nezávislou množinu
2. sousedy vyškrtáme
3. chceme graf rychle zmenšovat v každém kroku (ideálně třeba na polovinu)


Df: Značení
-----------
- `dv :=` aktuální stupeň vrcholu `v`


Alg: Maximální nezávislá množina
--------------------------------
- Vstup: `G = (V, E)`

1. `I := ∅`
2. `∀v ∈ V` paralelně:
3. 		Pokud `dv = 0`
4.   		`I = I ∪ {v}`
5.     		`V = V \ {v}`
6. Opakujeme dokud graf není prázdný:
7. 		`∀v ∈ V` paralelně:
8. 			Nezávisle s pravděpodobností `pv = 1 / 2dv` označíme vrchol v
9. 		`∀ {uv} ∈ E`:
10. 		Pokud `u` i `v` jsou označené:
11.  			Smažeme značku vrcholu nižšího stupně
12. 	`S :=` označené vrcholy
13. 	`N(S) :=` sousedi označených vrcholů
14. 	`E = {{uv} ∈ E: {uv} ∉ S ∧ {uv} ∉ N(S)}`
15. 	`V = V \ (S ∪ N(S))`
16. 	`I = I ∪ S`
17. Vrátíme `I`



Pz: Maximální nezávislá množina
-------------------------------
1. potřebujeme polynomiálně procesorů
2. potřebujeme poly-logaritmický čas na cyklus
3. výsledek je maximální nezávislá množina


Pz: Volba parametru `p_v`
------------------------
1. `K_n`
	- chceme vybrat právě jeden, nebo nejvýš dva vrcholy
	- `1/n`
2. Párování
	- `1/2` nebo nějakou konstantu
- proto `1 / 2d_v`


Pz: Šance úspěchu
-----------------
- vrchol `v` označený vrchol `=> P[v ∈ S `po kroku` 12] ≥ 1/2`

### Důkaz:
+ vrchol ztratí značku, pokud je označený soused vyššího stupně
+ pravděpodobnosti `1/2d_v` považujeme za nezávislé
- `P[`označíme v`]  ≤  Σ_{w: vw ∈ E, d_w ≥ d_v} p_w  ≤  Σ 1/2d_v  ≤  d_v * 1/2d_v  =  1/2`


Df: Dobrý a špatný vrchol
-------------------------
1. vrchol `v` je "dobrý", pokud má `≥ d_v/3` sousedů stupně `≤ d_v`
2. jinak je špatný


Df: Dobrá a špatná hrana
------------------------
1. hrana `{uv}` je dobrá, pokud je `u` nebo `v` dobrý
2. jinak je špatná


Pz: Dobrý vrchol 1
------------------
- `v` je dobrý  `=>  p = P[`v 8 označím aspoň jednoho souseda`] ≥ β > 0.15`

### Důkaz:
- `p  ≥  1 - π_{w ∈ N(v)} (1 - 1/2d_w)  ≥  1 - π_{w ∈ N(v): d_w ≤ d_v} (1 - 1/2d_w) ≥ 1 - (1 - 1/2d_v)^{d_v/3}  ≥  1 - e^{-1/6}  =  β`
	- otočení pravděpodobnosti a smazání `1 -` se to asi zpřehlední
	

Pz: Hvězda
----------
- hvězda má málo dobrých vrcholů - dobrý je jen prostřední


Lm: Dobrá hrana
---------------
- `|\{e ∈ E: ¶e je dobrá¶\}| ≥ |E|/2`

### Důkaz:
- zorientujeme hrany `{u,v} -> (u,v): du ≤ dv`
- buď `v` špatný vrchol
- hran orientovaných do něj `< d_v/3` z definice špatného vrcholu
- hran orientovaných ven je `> 2d_v/3`
- každé (špatné) vstupující hraně přiřadíme dvě vystupující hrany "pomocnými hranami"
- pro každou špatnou hranu máme aspoň dvě dobré?


Vt: Složitost
-------------
- `𝔼[`# cyklů`] ≤ O(log m)`

### Důkaz:
- `Ei` hrany po `i` cyklech
- polovina hran je dobrých
- každá dobrá hrana zmizí s pravděpodobností aspoň `β/2`
- v průměru zmizí `β/4` část hran
- `𝔼[E{i + 1}] ≤ (1 - β/4) * |Ei|`
- `𝔼[|Ei| ≤ (1 - β/4)^i * |E|`
- `=> 𝔼[`# cyklů`] ≤ O(log m)`


Alg: Po dvou nezávislý
----------------------
- vrcholy označíme s pravděpodobností `p_v` ale ne nezávisle, jen po dvou nezávisle
- pozorování stále platí i pro dvou-nezávislost, kromě posledního dokázaného, musíme dokázat znova


Pz: Dobrý vrchol 2
------------------
- `v` je dobrý  `=>  p = P[`v 8 označím aspoň jednoho souseda`] ≥ β > 0.15`

### Důkaz:
- `D := \{w: w ∈ N(v), d_w ≤ d_v\}`
- jev `A_w :=` označíme `w ∈ D`
- `P[∪ A_w] = 1 - π_{w ∈ D} (1 - p_w) = Σ p_w - Σ p_w * p_w' - ...`
	+ produkt je pro nezávislé
	+ můžeme využít jen první dva sčítance, ostatní neplatí
- z inkluze exkluze `|∪ A_w| ≥ Σ|A_w| - Σ|A_w ∩ A_w'|` platí i pro po dvou nezávislé
- `P[A_w] ≥ Σ_{w ∈ D} pw - 1/2 Σ_{w,w' ∈ D: w ≠ w'} p_w * p_{w'}`
	+ bez podmínky `w ≠ w'` se výsledek zmenší, počítání se zjednoduší
- `≥ Σ_{w ∈ D} p_w (1 - 1/2 Σ_{w' ∈ D} p_{w'}) ≥?≥ β'`
1. `|D| ≤ 2` - platí počty pro obecnou závislost
2. `|D| ≥ 3`
	- `Σ_{w ∈ D} p_w ≥ 1/6`
		+ viz `1 - e^{-1/6}  =  β`
	- `D' ⊆ D: Σ_{w ∈ D'} p_w ≥ 1/6`, `D'` je minimální do inkluze
	- `|D| ≥ 3  =>  Σ_{w ∈ D'} p_w ≤ 1/4`
		+ rozmyslet doma
		+ je tam číslo menší, než `1/12`, které nemůžeme vyhodit
	- `β' = 1/6 * (1 - 1/6) = 1/8 = 0.125`